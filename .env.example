# ============================================================================
# PM Document Intelligence Agent - Environment Configuration
# ============================================================================
# Copy this file to .env and fill in your actual values
# NEVER commit .env to version control

# ============================================================================
# Application Configuration
# ============================================================================
APP_NAME=pm-document-intelligence
ENVIRONMENT=development  # development, staging, production
DEBUG=true
SECRET_KEY=your-secret-key-here-generate-with-openssl-rand-hex-32
ALLOWED_HOSTS=localhost,127.0.0.1
CORS_ORIGINS=http://localhost:3000,http://localhost:8000

# ============================================================================
# Server Configuration
# ============================================================================
HOST=0.0.0.0
PORT=8000
WORKERS=4
RELOAD=true

# ============================================================================
# AWS Configuration
# ============================================================================
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your-aws-access-key-id
AWS_SECRET_ACCESS_KEY=your-aws-secret-access-key
AWS_SESSION_TOKEN=  # Optional, for temporary credentials

# AWS Service Limits
AWS_MAX_CONCURRENT_REQUESTS=100
AWS_REQUEST_TIMEOUT=300

# ============================================================================
# AWS Bedrock Configuration
# ============================================================================
BEDROCK_MODEL_ID=anthropic.claude-3-5-sonnet-20241022-v2:0
BEDROCK_MAX_TOKENS=4096
BEDROCK_TEMPERATURE=0.7
BEDROCK_TOP_P=0.9
BEDROCK_REGION=us-east-1

# Rate Limiting for Bedrock
BEDROCK_RATE_LIMIT_PER_MINUTE=60
BEDROCK_RATE_LIMIT_PER_HOUR=1000

# ============================================================================
# AWS Textract Configuration
# ============================================================================
TEXTRACT_ENABLED=true
TEXTRACT_MAX_PAGES=100
TEXTRACT_TIMEOUT=300

# ============================================================================
# AWS Comprehend Configuration
# ============================================================================
COMPREHEND_ENABLED=true
COMPREHEND_MAX_TEXT_LENGTH=100000
COMPREHEND_LANGUAGE_CODE=en

# ============================================================================
# OpenAI Configuration
# ============================================================================
OPENAI_API_KEY=your-openai-api-key-here
OPENAI_MODEL=gpt-4o-mini  # gpt-4o-mini for dev, gpt-4o for production
OPENAI_MAX_TOKENS=4096
OPENAI_TEMPERATURE=0.7

# OpenAI Rate Limiting
OPENAI_RATE_LIMIT_PER_MINUTE=100
OPENAI_RATE_LIMIT_PER_DAY=10000
OPENAI_MAX_RETRIES=3
OPENAI_RETRY_DELAY=1

# ============================================================================
# RDS PostgreSQL Database Configuration
# ============================================================================
# AWS RDS PostgreSQL Database URL format:
# postgresql://username:password@endpoint:port/database_name
DATABASE_URL=postgresql://pmadmin:your-password@your-rds-endpoint.rds.amazonaws.com:5432/pm_document_intelligence
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10
DATABASE_POOL_RECYCLE=3600
DATABASE_ECHO=false

# ============================================================================
# PubNub Configuration
# ============================================================================
PUBNUB_PUBLISH_KEY=your-pubnub-publish-key
PUBNUB_SUBSCRIBE_KEY=your-pubnub-subscribe-key
PUBNUB_SECRET_KEY=your-pubnub-secret-key
PUBNUB_SSL=true
PUBNUB_UUID=pm-document-intelligence-backend

# ============================================================================
# Security Configuration
# ============================================================================
# JWT Configuration
JWT_SECRET_KEY=your-jwt-secret-key-generate-with-openssl-rand-hex-32
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# Password Hashing
BCRYPT_ROUNDS=12

# API Keys
API_KEY_HEADER=X-API-Key
API_KEY_SALT=your-api-key-salt

# ============================================================================
# Rate Limiting Configuration
# ============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_STRATEGY=fixed-window  # fixed-window, sliding-window
RATE_LIMIT_DEFAULT=100/minute
RATE_LIMIT_STORAGE=redis

# Per-endpoint rate limits
RATE_LIMIT_UPLOAD=10/minute
RATE_LIMIT_PROCESS=20/minute
RATE_LIMIT_QUERY=100/minute

# ============================================================================
# Redis Configuration
# ============================================================================
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=
REDIS_MAX_CONNECTIONS=50
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5

# ============================================================================
# Celery Configuration
# ============================================================================
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=json
CELERY_TIMEZONE=UTC
CELERY_ENABLE_UTC=true

# Task Configuration
CELERY_TASK_TIME_LIMIT=3600
CELERY_TASK_SOFT_TIME_LIMIT=3000
CELERY_TASK_MAX_RETRIES=3
CELERY_TASK_DEFAULT_RETRY_DELAY=60

# ============================================================================
# Monitoring & Observability
# ============================================================================
# Sentry
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENABLED=true
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1

# Metrics
METRICS_ENABLED=true
METRICS_PORT=9090
PROMETHEUS_MULTIPROC_DIR=/tmp/prometheus

# Logging
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json  # json, text
LOG_FILE=logs/app.log
LOG_ROTATION=10MB
LOG_RETENTION=30 days

# ============================================================================
# Feature Flags
# ============================================================================
FEATURE_CACHING_ENABLED=true
FEATURE_VECTOR_SEARCH_ENABLED=true
FEATURE_MULTI_MODAL_ENABLED=true
FEATURE_REAL_TIME_UPDATES_ENABLED=true
FEATURE_BATCH_PROCESSING_ENABLED=true
FEATURE_ADVANCED_ANALYTICS_ENABLED=false

# ============================================================================
# Caching Configuration
# ============================================================================
CACHE_ENABLED=true
CACHE_TYPE=redis  # redis, memory
CACHE_DEFAULT_TTL=3600
CACHE_MAX_SIZE=1000

# Document Processing Cache
CACHE_DOCUMENT_TTL=7200
CACHE_ANALYSIS_TTL=3600
CACHE_QUERY_TTL=1800

# ============================================================================
# Storage Configuration
# ============================================================================
# File Upload
UPLOAD_DIR=uploads
MAX_UPLOAD_SIZE=52428800  # 50MB in bytes
ALLOWED_EXTENSIONS=pdf,docx,doc,txt,xlsx,xls,pptx,ppt

# S3 Storage (optional)
S3_BUCKET_NAME=pm-document-intelligence
S3_UPLOAD_PATH=documents/
S3_PRESIGNED_URL_EXPIRY=3600

# ============================================================================
# Vector Search Configuration
# ============================================================================
VECTOR_DB_TYPE=postgresql  # postgresql (RDS with pgvector), pinecone, weaviate
VECTOR_DIMENSION=1536
VECTOR_SIMILARITY_THRESHOLD=0.7
EMBEDDING_MODEL=text-embedding-3-small

# ============================================================================
# Document Processing Configuration
# ============================================================================
MAX_CONCURRENT_PROCESSING=5
PROCESSING_TIMEOUT=600
OCR_ENABLED=true
NER_ENABLED=true
SENTIMENT_ANALYSIS_ENABLED=true
KEY_PHRASE_EXTRACTION_ENABLED=true

# ============================================================================
# Agent Configuration
# ============================================================================
AGENT_MAX_ITERATIONS=10
AGENT_TIMEOUT=300
AGENT_MEMORY_ENABLED=true
AGENT_TOOLS_ENABLED=textract,comprehend,search,summarize,analyze

# ============================================================================
# MCP (Model Context Protocol) Configuration
# ============================================================================
MCP_ENABLED=true
MCP_SERVER_PORT=8001
MCP_MAX_CONTEXT_LENGTH=100000
MCP_TOOLS_ENABLED=true

# ============================================================================
# Development & Testing
# ============================================================================
TESTING=false
TEST_DATABASE_URL=postgresql://user:password@localhost:5432/test_db
MOCK_AWS_SERVICES=false
ENABLE_PROFILING=false

# ============================================================================
# Production Optimizations
# ============================================================================
GZIP_ENABLED=true
GZIP_MIN_SIZE=1000
COMPRESSION_LEVEL=6

# Connection Pooling
CONNECTION_POOL_SIZE=20
CONNECTION_MAX_OVERFLOW=10
CONNECTION_POOL_RECYCLE=3600

# ============================================================================
# Health Check Configuration
# ============================================================================
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
READINESS_CHECK_PATH=/ready
